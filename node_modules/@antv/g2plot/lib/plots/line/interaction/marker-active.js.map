{"version":3,"file":"marker-active.js","sourceRoot":"","sources":["../../../../src/plots/line/interaction/marker-active.ts"],"names":[],"mappings":";;;;AAAA,mCAAqD;AACrD,kDAO6B;AAE7B,aAAa;AACb;IAA6C,mDAAiB;IAA9D;;IASA,CAAC;IARC,sBAAW,yCAAI;aAAf;YACE,OAAO,gBAAgB,CAAC;QAC1B,CAAC;;;OAAA;IACS,+CAAa,GAAvB;QACE,aAAa;QACb,IAAM,GAAG,GAAG,iBAAM,aAAa,WAAE,CAAC;QAClC,6CAAY,GAAG,KAAE,cAAc,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,IAAG;IAC5E,CAAC;IACH,8BAAC;AAAD,CAAC,AATD,CAA6C,8BAAiB,GAS7D;AATY,0DAAuB;AAWpC,wCAA2B,CAAC,gBAAgB,EAAE,uBAAuB,CAAC,CAAC;AAEvE;IAAiC,8CAAiB;IAAlD;;IAmDA,CAAC;IAlDQ,iCAAI,GAAX;QACE,iBAAiB;QACjB,IAAI,CAAC,OAAO,EAAE,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;IAC9C,CAAC;IAEM,iCAAI,GAAX;QACE,IAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QACpC,IAAI,WAAW,EAAE;YACf,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SAC/B;IACH,CAAC;IAEM,iCAAI,GAAX;QACE,IAAM,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QAC5B,IAAM,UAAU,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC/C,UAAU,CAAC,WAAW,EAAE,CAAC;QACzB,IAAM,MAAM,GAAe,aAAM,CAAC,IAAI,CAAC,UAAU,EAAE,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,IAAI,IAAI,OAAO,EAApB,CAAoB,CAAC,CAAC;QACnF,WAAI,CAAC,MAAM,EAAE,UAAC,KAAe;YAC3B,WAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,UAAC,OAAO;gBAC3B,OAAO,CAAC,QAAQ,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;YACpC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,wCAAW,GAAlB,UAAmB,KAAY;QAC7B,IAAM,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QAC5B,IAAM,UAAU,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC/C,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAC9B,IAAM,KAAK,GAAG,UAAU,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;QAChD,IAAM,MAAM,GAAe,aAAM,CAAC,IAAI,CAAC,UAAU,EAAE,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,IAAI,IAAI,OAAO,EAApB,CAAoB,CAAC,CAAC;QACnF,WAAI,CAAC,MAAM,EAAE,UAAC,KAAe;YAC3B,WAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,UAAC,OAAO;gBAC3B,OAAO,CAAC,QAAQ,CAAC,QAAQ,EAAE,gBAAS,CAAC,KAAK,EAAE,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,IAAI,KAAK,OAAO,CAAC,IAAI,EAA1B,CAA0B,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC5F,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,qCAAQ,GAAhB;QACE,IAAM,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC;QAE9B,OAAO,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;IAC1C,CAAC;IAEO,oCAAO,GAAf;QACE,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;IAC3B,CAAC;IAEO,iDAAoB,GAA5B;QACE,OAAO,IAAI,CAAC,OAAO,EAAE,CAAC,aAAa,CAAC,gBAAgB,CAAsB,CAAC;IAC7E,CAAC;IACH,yBAAC;AAAD,CAAC,AAnDD,CAAiC,8BAAiB,GAmDjD;AAED,kBAAe,kBAAkB,CAAC","sourcesContent":["import { filter, each, findIndex } from '@antv/util';\nimport {\n  InteractionAction,\n  View,\n  TooltipController,\n  Point,\n  registerComponentController,\n  Geometry,\n} from '../../../dependents';\n\n// @ts-ignore\nexport class ActiveTooltipController extends TooltipController {\n  public get name(): string {\n    return 'tooltip-active';\n  }\n  protected getTooltipCfg() {\n    // @ts-ignore\n    const cfg = super.getTooltipCfg();\n    return { ...cfg, showCrosshairs: true, showMarkers: false, shared: true };\n  }\n}\n\nregisterComponentController('tooltip-active', ActiveTooltipController);\n\nclass MarkerActiveAction extends InteractionAction {\n  public init() {\n    // 移除默认的tooltip交互\n    this.getView().removeInteraction('tooltip');\n  }\n\n  public show() {\n    const curLocation = this.getPoint();\n    if (curLocation) {\n      this.showTooltip(curLocation);\n    }\n  }\n\n  public hide() {\n    const view = this.getView();\n    const controller = this.getTooltipController();\n    controller.hideTooltip();\n    const points: Geometry[] = filter(view.geometries, (geom) => geom.type == 'point');\n    each(points, (point: Geometry) => {\n      each(point.elements, (element) => {\n        element.setState('active', false);\n      });\n    });\n  }\n\n  public showTooltip(point: Point) {\n    const view = this.getView();\n    const controller = this.getTooltipController();\n    controller.showTooltip(point);\n    const items = controller.getTooltipItems(point);\n    const points: Geometry[] = filter(view.geometries, (geom) => geom.type == 'point');\n    each(points, (point: Geometry) => {\n      each(point.elements, (element) => {\n        element.setState('active', findIndex(items, (item) => item.data === element.data) !== -1);\n      });\n    });\n  }\n\n  private getPoint(): Point | null {\n    const ev = this.context.event;\n\n    return ev ? { x: ev.x, y: ev.y } : null;\n  }\n\n  private getView(): View {\n    return this.context.view;\n  }\n\n  private getTooltipController() {\n    return this.getView().getController('tooltip-active') as TooltipController;\n  }\n}\n\nexport default MarkerActiveAction;\n"]}